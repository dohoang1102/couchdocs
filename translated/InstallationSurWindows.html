<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>CouchDocs - InstallationSurWindows</title>
    <link rel="stylesheet" href="/css/style.css" type="text/css" media="screen" />
  </head>
  <body>
    <div id="wrapper"> 
      <div id="header">
          <h1><a href="/">CouchDocs</a></h1>
      </div>
      <div id="menu">
        <ul>
        <li>Overview</li>
        <li>Installation</li>
        <li>Introduction</li>
        <li>Conventions</li>
        <li>
          Sections
          <ul>
            <li>Databases</li>
            <li>
              Documents
              <ul>
                <li>Design</li>
                <li>Local</li>
              </ul>
            </li>
            <li>Views</li>
            <li>Rendering</li>
            <li>Configuration</li>
            <li>Statistics</li>
            <li>Security</li>
          </ul>
        </li>
        <li>API Reference</li>
        <li>Client Libraries</li>
        <li>How do I?</li>
        <li>FAQ</li>
      </ul>
        
</div>
      <div id="content">
  <!-- #language fr -->

<p>CouchDB ne s'installe pas nativement sur  Windows mais il est possible de l'installer à la main.</p>
<p>Merci de mettre à jour ce guide si nécessaire, nous souhaitons récupérer votre retour d'expérience afin de l'intégrer dans la procedédure d'installation officielle.</p>
<h2>Dépendances</h2>
<p>Vous avez besoin des logiciels suivants installés sur votre système :</p>
<ul>
<li><a href="http://www.erlang.org/download.html">Erlang/OTP</a></li>
<li>C Compiler/Linker (such as <a href="http://gcc.gnu.org/">GCC</a> or <a href="http://msdn.microsoft.com/en-us/visualc/default.aspx">Visual C++</a>)</li>
<li>Make (such as <a href="http://www.gnu.org/software/make/">GNU Make</a> or <a href="http://msdn.microsoft.com/en-us/library/dd9y37ha(VS.71).aspx">nmake</a>)</li>
<li><a href="http://www.openssl.org/">OpenSSL</a></li>
<li><a href="http://www.icu-project.org/">ICU</a></li>
<li><a href="http://www.mozilla.org/js/spidermonkey/">SpiderMonkey</a></li>
</ul>
<h2>Installation de base</h2>
<p>Après avoir installé Erlang vous devez obtenir quelque chose de similaire à :</p>
<pre><code>C:\Program Files\erl5.6.3
</code></pre>
<p>Copiez l'arborescence complète du source de Couchdb ici :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\couchdb-0.8.0
</code></pre>
<p>Créeez le dossier vide suivant :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\mochiweb-0.01\ebin
</code></pre>
<p>À partir de ICU copiez <code>icu*.dll</code> et <code>libeay32.dll</code> vers :</p>
<pre><code>C:\Program Files\erl5.6.3\erts-5.6.2\bin
</code></pre>
<p>De !SpiderMonkey copiez <code>js32.dll</code> et  <code>jsshell.exe</code> vers :</p>
<pre><code>C:\Program Files\erl5.6.3\erts-5.6.2\bin
</code></pre>
<h2>Compilation C</h2>
<h3>couchdb/couch_erl_driver.c</h3>
<p>C'est la couche qui fournit les fonctionnalités de ICU à CouchDB.</p>
<p>Le plus simple pour compiler une DLL est de créer un projet Win32 DLL dans un IDE, ajoutez <code>couch_erl_driver.c</code> au projet, et changez les préférences du projet pour inclure les chemins de Erlang ERTS et des fichiers d'entêtes de ICU4C.</p>
<p>Créez le dossier vide suivant :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\couchdb-0.8.0\priv
</code></pre>
<p>Copiez la DDL vers :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\couchdb-0.8.0\priv\couch_erl_driver.dll
</code></pre>
<h3>couchdb/couch_js.c</h3>
<p>C'est la couche qui fournit UTF-8 et les améliorations cache à !SpiderMonkey.</p>
<p>Remplacez js.c par couch_js.c, et changez '#include <jsapi.h>' en '#include "jsapi.h"', ensuite compilez js.exe à nouveau, renommez le en couch_js.exe et copiez le vers :</p>
<pre><code>C:\Program Files\erl5.6.3\erts-5.6.2\bin
</code></pre>
<h2>Compilation Erlang</h2>
<p>Créez le fichier suivant :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\couchdb-0.8.0\src\Emakefile
</code></pre>
<p>Ajoutez le contenu suivant :</p>
<pre><code>{'./couchdb/*', [{outdir,"../ebin"}]}.
{'./mochiweb/*', [{outdir,"../../mochiweb-0.01/ebin"}]}.
</code></pre>
<p>Lançez <code>erl</code> (ou <code>werl</code>) et executez la commande suivante pour changer le dossier :</p>
<pre><code>cd("C:/Program Files/erl5.6.3/lib/couchdb-0.8.0/src").
</code></pre>
<p>Exécutez cette commande pour compiler CouchDB :</p>
<pre><code>make:all().
</code></pre>
<h2>Configuration</h2>
<p>Copiez le fichier suivant :</p>
<pre><code>C:\Program Files\erl5.6.3\lib\couchdb-0.8.0\etc\couchdb\couch.ini.tpl.in
</code></pre>
<p>ici :</p>
<pre><code>C:/Program Files/erl5.6.3/bin/couch.ini
</code></pre>
<p>Éditez ce fichier de la façon suivante :</p>
<pre><code>[Couch]

ConsoleStartupMsg=Apache CouchDB is starting.

DbRootDir=C:/Path/To/Database/Directory

Port=5984

BindAddress=127.0.0.1

DocumentRoot=C:/Program Files/erl5.6.3/lib/couchdb-0.8.0/share/www

LogFile=C:/Path/To/Log/Directory

UtilDriverDir=C:/Program Files/erl5.6.3/lib/couchdb-0.8.0/priv/couch_erl_driver.dll

LogLevel=info

[Couch Query Servers]

javascript=couch_js "C:/Program Files/erl5.6.3/lib/couchdb-0.8.0/share/server/main.js"
</code></pre>
<p>Make sure that the <code>DbRootDir</code> exists and that the <code>LogFile</code> can be created.</p>
<h2>Exécution</h2>
<p>Lançez <code>erl</code> (ou <code>werl</code>) et exécutez la commande suivante :</p>
<pre><code>couch_server:start().
</code></pre>
<p>Pour voir si tout a fonctionné à ce point de l'installation, rendez-vous avec votre navigateur sur 
<a href="localhost:5984/_utils/index.html">localhost:5984/_utils/index.html</a> et lançez <code>test suite</code>.</p>
</div>
      <div id="footer">
        <p>Hosted on <a href="http://github.com/">Github</a></p>
      </div>
    </div>
  </body>
</html>