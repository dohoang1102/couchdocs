<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>CouchDocs - Replication</title>
    <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" />
    <link rel="stylesheet" href="../css/code_highlight.css" type="text/css" media="screen" />
  </head>
  <body>
    <div id="wrapper"> 
      <div id="header">
          <h1><a href="/">CouchDocs</a></h1>
      </div>
      <div id="menu">
  <strong>Navigation</strong>
<ul>
  <li><a href="FrontPage.html">Overview</a></li>
  <li><a href="FrontPage.html#using-couchdb">Using CouchDB</a></li>
  <li><a href="FrontPage.html#when-things-go-wrong">When Things Go Wrong</a></li>
  <li><a href="FrontPage.html#community">Community</a></li>
  <li><a href="FrontPage.html#getting-involved">Get Involved</a></li>
  <li><a href="FrontPage.html#books">Books</a></li>
</ul>

<strong>Short Cuts</strong>
<ul>
  <li><a href="Reference.html">Reference</a></li>
  <li><a href="Frequently_asked_questions.html">FAQ</a></li>
</ul>


      <!-- <ul>
        <li>Overview</li>
        <li>Installation</li>
        <li>Introduction</li>
        <li>Conventions</li>
        <li>
          Sections
          <ul>
            <li>Databases</li>
            <li>
              Documents
              <ul>
                <li>Design</li>
                <li>Local</li>
              </ul>
            </li>
            <li>Views</li>
            <li>Rendering</li>
            <li>Configuration</li>
            <li>Statistics</li>
            <li>Security</li>
          </ul>
        </li>
        <li>API Reference</li>
        <li>Client Libraries</li>
        <li>How do I?</li>
        <li>FAQ</li>
      </ul> -->
        
</div>
      <div id="content">
  <h1 id="replication">Replication</h1>
<div class="toc">
<ul>
<li><a href="#replication">Replication</a><ul>
<li><a href="#overview">Overview</a><ul>
<li><a href="#run-replication">Run Replication</a></li>
<li><a href="#continuous-replication">Continuous replication</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="overview">Overview</h2>
<p>The replication is an incremental one way process involving two databases (a source and a destination).</p>
<p>The aim of the replication is that at the end of the process, all active documents on the source database are also in the destination database and all documents that were deleted in the source databases are also deleted (if exists) on the destination database.</p>
<p>The replication process only copies the last revision of a document, so all previous revisions that were only on the source database are not copied to the destination database.</p>
<p><strong>Changes on the master will not automatically replicate to the slaves</strong></p>
<h3 id="run-replication">Run Replication</h3>
<p>Replication is triggered by sending a POST request to the <code>_replicate</code> URL with a JSON object in the body that includes a <code>source</code> and a <code>target</code> member.</p>
<div class="codehilite"><pre><span class="n">POST</span> <span class="sr">/_replicate HTTP/</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span>

<span class="p">{</span><span class="s">&quot;source&quot;</span><span class="p">:</span><span class="s">&quot;example-database&quot;</span><span class="p">,</span><span class="s">&quot;target&quot;</span><span class="p">:</span><span class="s">&quot;http://example.org/example-database&quot;</span><span class="p">}</span>
</pre></div>


<p><code>source</code> and <code>target</code> can both point at local databases, remote databases and any combination of these.</p>
<p>If your local CouchDB instance is secured by an admin account, you need to use the full URL format</p>
<div class="codehilite"><pre><span class="n">POST</span> <span class="sr">/_replicate HTTP/</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span>

<span class="p">{</span><span class="s">&quot;source&quot;</span><span class="p">:</span><span class="s">&quot;http://example.org/example-database&quot;</span><span class="p">,</span><span class="s">&quot;target&quot;</span><span class="p">:</span><span class="s">&quot;http://admin:password@127.0.0.1:5984/example-database&quot;</span><span class="p">}</span>
</pre></div>


<p>The target database has to exist and is not implicitly created. Add <code>create_target:true</code> to the JSON object to create the target database (remote or local) prior to replication. The names of the source and target databases do not have to be the same.</p>
<p>Specifying a local <code>source</code> database and a remote <code>target</code> database is called <em>push replication</em> and a remote <code>source</code> and local <code>target</code> is called <em>pull replication</em>. As of CouchDB 0.9, pull replication is a lot more efficient and resistant to errors, and it is suggested that you use pull replication in most cases, especially if your documents are large or you have large attachments.</p>
<h3 id="continuous-replication">Continuous replication</h3>
<p>To make replication continuous, add "continuous":true parameter to JSON, for example:</p>
<div class="codehilite"><pre><span class="n">POST</span> <span class="sr">/_replicate HTTP/</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span>

<span class="p">{</span><span class="s">&quot;source&quot;</span><span class="p">:</span><span class="s">&quot;http://example.org/example-database&quot;</span><span class="p">,</span><span class="s">&quot;target&quot;</span><span class="p">:</span><span class="s">&quot;http://admin:password@127.0.0.1:5984/example-database&quot;</span><span class="p">,</span> <span class="s">&quot;continuous&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>


<p>At this time, CouchDB doesnâ€™t remember continuous replications over a server restart. For more info visit <a href="http://books.couchdb.org/relax/reference/replication">http://books.couchdb.org/relax/reference/replication</a> - CouchDB: The Definitive Guide, chapter Replication.</p>
<p>See also: 
 * <a class="internal" href="Replication_and_conflicts.html">Replication_and_conflicts</a>
 * <a class="internal" href="How_to_design_for_replication.html">How_to_design_for_replication</a></p>
</div>
      <div id="footer">
        <p>Hosted on <a href="http://github.com/">Github</a></p>
      </div>
    </div>
  </body>
</html>